# FitCoach — Функциональные спецификации

## 1. Общая концепция

FitCoach — персональный трекер здоровья и привычек с функцией дневного ИИ-наставника. Приложение помогает пользователю вести структурированные записи по питанию, тренировкам, воде, сну, настроению и общему самочувствию. В конце дня AI-модуль анализирует данные и создаёт мотивационный summary с оценкой эффективности дня.

---

## 2. Основные пользовательские сценарии

### 2.1 Регистрация и вход

* Регистрация через email + пароль.
* Авторизация с использованием JWT-токена.
* Возможность сброса пароля через email.

### 2.2 Главный экран / Календарь

* Отображение календаря с днями (цветовая индикация по оценке усердия).
* Клик по дню → открывается «Карточка дня».
* Быстрая навигация по неделям/месяцам.

### 2.3 Карточка дня

* Основной экран ввода данных за день.
* Вкладки/секции:

  * Питание
  * Спорт
  * Вода
  * Сон
  * Настроение
  * Заметки
  * Итог дня (LLM Summary)

---

## 3. Подразделы карточки дня

### 3.1 Питание

**Цель:** фиксировать приёмы пищи и получать оценку питания от AI.

**Поля:**

* Категория: Завтрак / Обед / Ужин / Перекус.
* Список блюд: название, количество, калорийность (опционально).
* Возможность добавить фото блюда (локально, без облака).
* Комментарий пользователя.

**Функции:**

* Автоматический расчёт общей калорийности (если введены данные).
* Кнопка «AI Summary» — короткий отзыв LLM по рациону дня.
* Подсветка приёмов пищи с переизбытком калорий.

---

### 3.2 Спорт

**Цель:** отслеживание физической активности и тренировок.

**Поля:**

* Тип: Бег / Зал / Йога / Другое.
* Время начала / длительность.
* Дистанция (для бега).
* Субъективная оценка нагрузки (1–5).
* Комментарий.

**Функции:**

* Расчёт суммарной активности за день (ккал / мин / км).
* Кнопка «AI Summary» — рекомендации по восстановлению или нагрузке на завтра.
* График недельной активности.

---

### 3.3 Вода

**Цель:** контролировать водный баланс.

**Поля:**

* Цель (по умолчанию 2.5 л, можно изменить).
* Текущее количество (накапливается).

**Функции:**

* Быстрые кнопки: +0.25 л, +0.5 л.
* Визуальная шкала заполнения цели (синяя анимация).
* Автоматическая отметка выполнения при достижении цели.

---

### 3.4 Сон

**Цель:** фиксировать продолжительность и качество сна.

**Поля:**

* Время отхода ко сну / подъёма.
* Продолжительность (автоматически считается).
* Качество (оценка 1–5).
* Комментарий.

**Функции:**

* Автоматическое определение дефицита сна (<7 ч).
* AI Summary — рекомендации по режиму.

---

### 3.5 Настроение

**Цель:** отслеживать эмоциональное состояние.

**Поля:**

* Оценка дня (1–5).
* Теги: стресс / фокус / энергия / раздражение / вдохновение.
* Короткая заметка.

**Функции:**

* Анализ тегов в динамике (график).
* AI Summary — эмоциональный анализ.

---

### 3.6 Заметки

**Цель:** личный дневник, не связанный с другими параметрами.

**Функции:**

* Markdown-редактор.
* Возможность прикрепить изображение или аудиозаметку (локально).

---

### 3.7 Итог дня (LLM Summary)

**Цель:** автоматический анализ всех данных дня.

**Действия:**

* Кнопка «Сгенерировать отчёт».
* LLM получает данные по всем секциям.
* Возвращает:

  * `summary_day` — общий текст отчёта (4–6 предложений).
  * `effort_score` (0–10) — оценка усердия.
  * `reason` — короткое объяснение.
  * `micro_step` — совет на завтра.

**Дополнительно:**

* AI пишет в поддерживающем тоне, без лести.
* Summary кэшируется и может быть перегенерировано.

---

## 4. Раздел «Статистика»

**Функции:**

* Просмотр графиков за неделю / месяц:

  * Вес (кг)
  * Активность (мин / км)
  * Калорийность питания
  * Количество воды
  * Сон (часы)
  * Настроение (среднее)
  * Оценка усердия (AI)
* Вывод средних значений и трендов.
* Экспорт графиков в изображение.

---

## 5. Профиль и настройки

**Разделы:**

* Персональные данные (имя, возраст, рост, вес, цель по весу).
* Настройки AI:

  * Язык (RU/EN/CZ)
  * Модель (GPT / Gemini / Local)
  * Тон общения (нейтральный / мотивирующий)
* Настройки уведомлений (ежедневное напоминание записать день).
* Настройка водной цели, калорийной цели и часов сна.

---

## 6. Экспорт и импорт данных

* Экспорт всех записей за период в JSON.
* Импорт сохранённых данных.
* Опциональное шифрование архива (AES).

---

## 7. Дополнительные функции

* Автоматическое резервное копирование данных локально.
* Быстрые виджеты (для iOS): добавление воды, активности или заметки.
* Ночной режим и адаптивная цветовая схема.

---

## 8. Функционал LLM-наставника (подробно)

**Модель:** GPT-4 / Claude / Gemini (через LangChain).

**Возможности:**

1. Генерация дневных отчётов (summary + совет).
2. Парсинг и анализ питания (баланс БЖУ, режим).
3. Коррекция оценки усердия (на +/–1 балл с объяснением).
4. Создание недельных отчётов («прогресс и тенденции»).
5. Микрошаги на неделю (изменить воду, добавить прогулки и т.д.).

**Интерфейс:**

* Вкладка «Наставник» с историей отчётов.
* Возможность задать вопрос AI («что улучшить завтра?»).

---

## 9. Безопасность и приватность

* Все данные хранятся на сервере PostgreSQL, доступ только по токену.
* Ключи OpenAI хранятся только на сервере.
* SSL/HTTPS для всех соединений.
* Локальные кэши SQLite / CoreData не содержат токенов.

---

## 10. Нефункциональные требования

* Быстрый отклик UI (<100 мс локально, <1 с при запросах).
* Работа офлайн (запись сохраняется и синхронизируется при подключении).
* 100% совместимость лицензий MIT / Apache / BSD / PostgreSQL.

---

## 11. Потенциальные будущие функции

* Интеграция со Strava / Apple Health / Garmin.
* Расширенный коучинг AI (многошаговый диалог).
* Голосовой ввод заметок.
* Планировщик целей (недельные/месячные задачи).
